<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel Administrativo | Mercosul Line</title>

  <meta name="theme-color" content="#667eea">

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />

  <style>
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }

    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.18);
      border-radius: 20px;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
    }

    .page-wrap {
      max-width: 96rem;
      margin: 0 auto;
      padding: 1.5rem;
    }

    .tab {
      display: none;
    }

    .tab.active {
      display: block;
    }

    .tab-btn {
      padding: 0.75rem 1.5rem;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.5);
      color: #4a5568;
      font-weight: 600;
      font-size: 0.875rem;
      transition: all 0.3s ease;
    }

    .tab-btn.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .tab-btn:not(.active):hover {
      background: rgba(255, 255, 255, 0.7);
    }

    .kpi {
      border-radius: 16px;
      padding: 20px;
      color: #fff;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .kpi:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.2);
    }

    .kpi h3 {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      opacity: 0.9;
    }

    .kpi p {
      font-size: 2.5rem;
      font-weight: 800;
      line-height: 1;
    }

    .kpi-gradient-0 {
      background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
    }

    /* Mar√≠timo */
    .kpi-gradient-1 {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .kpi-gradient-2 {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .kpi-gradient-3 {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    .kpi-gradient-4 {
      background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
    }

    .table {
      width: 100%;
      table-layout: auto;
    }

    .table th,
    .table td {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      vertical-align: middle;
      font-size: 0.8rem;
      line-height: 1rem;
      padding: 0.75rem 1rem;
    }

    .sortable-header {
      cursor: pointer;
      user-select: none;
    }

    .sort-indicator {
      font-size: 0.7rem;
      color: #64748b;
      margin-left: 0.25rem;
    }

    .detail-cell {
      background: #f9fafb;
      border-top: 1px solid #e5e7eb;
      padding: 1rem 1.5rem;
      font-size: 0.8rem;
      line-height: 1.2rem;
    }

    .btn-modern {
      transition: all 0.3s ease;
    }

    .btn-modern:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    }

    .input-modern {
      transition: all 0.3s ease;
      border-radius: 12px;
    }

    .input-modern:focus {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .analytics-card {
      transition: all 0.3s ease;
    }

    .analytics-card:hover {
      transform: translateY(-5px);
    }
  </style>
</head>

<body>

  <header class="sticky top-0 z-50" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <div class="page-wrap flex items-center justify-between py-4 text-white">
      <h1 class="font-bold text-2xl">üéØ Painel Administrativo</h1>
      <button id="logout-btn"
        class="bg-white/20 hover:bg-white/30 px-6 py-2 rounded-xl font-semibold transition-all btn-modern">
        Sair
      </button>
    </div>
  </header>

  <main class="page-wrap mt-6 pb-12">

    <div class="glass-card p-2 mb-6">
      <div class="flex flex-wrap gap-2">
        <button class="tab-btn active" data-tab="tab-dashboard">üìä Dashboard</button>
        <button class="tab-btn" data-tab="tab-operacoes">üö¢ Opera√ß√µes</button>
        <button class="tab-btn" data-tab="tab-ocorrencias">üìã Ocorr√™ncias</button>
        <button class="tab-btn" data-tab="tab-upload">üì§ Upload</button>
        <button class="tab-btn" data-tab="tab-aprovacoes">‚úÖ Aprova√ß√µes</button>
        <button class="tab-btn" data-tab="tab-analytics">üìä Analytics</button>
        <button class="tab-btn" data-tab="tab-ferrovia">üöÇ Ferrovia Amcor</button>
      </div>
    </div>

    <div class="space-y-6">

      <section id="tab-dashboard" class="tab active">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
          <div class="kpi kpi-gradient-1" id="kpi-total-ops" style="cursor:pointer">
            <h3>Total de Opera√ß√µes</h3>
            <p id="kpi-total-value">0</p>
          </div>
          <div class="kpi kpi-gradient-2" id="kpi-late-ops" style="cursor:pointer">
            <h3>Em Atraso</h3>
            <p id="kpi-late-value">0</p>
          </div>
          <div class="kpi kpi-gradient-3" id="kpi-pct-late" style="cursor:pointer">
            <h3>% Atraso</h3>
            <p id="kpi-pct-value">0%</p>
          </div>
          <div class="kpi kpi-gradient-4" id="kpi-ontime-ops" style="cursor:pointer">
            <h3>No Prazo</h3>
            <p id="kpi-ontime-value">0</p>
          </div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="glass-card p-6">
            <h2 class="text-lg font-bold text-gray-900 mb-4">Top 5 Clientes com Atrasos</h2>
            <div style="height: 280px; position: relative;">
              <canvas id="delay-chart"></canvas>
            </div>
          </div>
          <div class="glass-card p-6">
            <h2 class="text-lg font-bold text-gray-900 mb-4">Principais Motivos de Atraso</h2>
            <div style="height: 280px; position: relative;">
              <canvas id="reasons-chart"></canvas>
            </div>
          </div>
        </div>
      </section>

      <section id="tab-operacoes" class="tab">
        <div class="glass-card p-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">Gest√£o de Opera√ß√µes</h2>
          <div id="late-alert" class="mb-6 p-4 rounded-xl bg-red-50 border border-red-200 hidden">
            <p id="late-alert-msg" class="text-red-700 font-semibold text-sm"></p>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div>
              <label class="block text-sm font-semibold mb-2">Embarcador(es)</label>
              <select id="filter-embarcador" multiple class="w-full input-modern border border-gray-300 p-3"></select>
            </div>
            <div>
              <label class="block text-sm font-semibold mb-2">Status</label>
              <select id="filter-status" class="w-full input-modern border border-gray-300 p-3">
                <option value="all">Todas</option>
                <option value="ontime">No Prazo</option>
                <option value="late">Em Atraso</option>
                <option value="canceled">Canceladas</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-semibold mb-2">Per√≠odo</label>
              <select id="filter-range" class="w-full input-modern border border-gray-300 p-3">
                <option value="7d">7 dias</option>
                <option value="30d" selected>30 dias</option>
                <option value="all">Tudo</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-semibold mb-2">Busca</label>
              <input id="filter-booking" type="text" placeholder="Booking/Container/Porto"
                class="w-full input-modern border border-gray-300 p-3" />
            </div>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
            <div>
              <label class="block text-sm font-semibold mb-2">Data Programada</label>
              <input id="filter-date" type="date" class="w-full input-modern border border-gray-300 p-3" />
            </div>
            <div class="flex items-end">
              <button id="clear-filters"
                class="w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-xl btn-modern font-semibold">Limpar
                Filtros</button>
            </div>
          </div>
          <div class="mb-6">
            <h3 class="text-sm font-semibold text-gray-800 mb-3">A√ß√µes</h3>
            <div class="flex flex-wrap gap-3">
              <button id="send-email-btn"
                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-xl btn-modern font-semibold">üìß Enviar
                E-mail ao Cliente</button>
              <button id="copy-email-btn"
                class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-3 rounded-xl btn-modern font-semibold">üìù
                Criar E-mail</button>
              <button id="open-diary-btn"
                class="bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-xl btn-modern font-semibold">üìñ
                Abrir Di√°rio de Bordo</button>
            </div>
          </div>
          <div class="flex justify-between items-center mb-4 p-4 bg-gray-50 rounded-xl">
            <div class="flex items-center gap-3 text-sm">
              <label>Mostrar:</label>
              <select id="items-per-page" class="border border-gray-300 rounded-lg px-3 py-2">
                <option value="10">10</option>
                <option value="25" selected>25</option>
                <option value="50">50</option>
                <option value="100">100</option>
                <option value="all">Todos</option>
              </select>
              <span>registros por p√°gina</span>
            </div>
            <div class="text-sm text-gray-600"><span id="showing-info">Mostrando 0 de 0</span></div>
          </div>
          <div class="overflow-x-auto border border-gray-200 rounded-xl mb-4">
            <table class="min-w-full divide-y divide-gray-200 table">
              <thead id="results-table-head" class="bg-gray-50">
                <tr class="text-left text-xs font-semibold text-gray-600 uppercase tracking-wide">
                  <th data-sort="Booking" class="px-6 py-4 sortable-header">Booking <span class="sort-indicator"></span>
                  </th>
                  <th data-sort="Cliente" class="px-6 py-4 sortable-header">Embarcador <span
                      class="sort-indicator"></span></th>
                  <th data-sort="PortoOperacao" class="px-6 py-4 sortable-header">Porto <span
                      class="sort-indicator"></span></th>
                  <th data-sort="DataProgramada" class="px-6 py-4 sortable-header">Previs√£o In√≠cio <span
                      class="sort-indicator"></span></th>
                  <th data-sort="DataChegada" class="px-6 py-4 sortable-header">In√≠cio Execu√ß√£o <span
                      class="sort-indicator"></span></th>
                  <th class="px-6 py-4 text-center">Atraso</th>
                  <th class="px-6 py-4">Motivo do Atraso</th>
                </tr>
              </thead>
              <tbody id="results-table-body" class="bg-white divide-y divide-gray-100 text-sm"></tbody>
            </table>
          </div>
          <div class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
            <div class="text-sm text-gray-600"><span id="showing-info-bottom">Mostrando 0 de 0</span></div>
            <div class="flex items-center gap-3">
              <button id="prev-page"
                class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg btn-modern font-semibold">‚Üê
                Anterior</button>
              <span id="current-page-display" class="text-sm font-medium">P√°gina 1</span>
              <button id="next-page"
                class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg btn-modern font-semibold">Proximo ‚Üí
              </button>
            </div>
          </div>
          <section id="email-preview" class="hidden mt-6 p-6 rounded-xl bg-indigo-50 border border-indigo-200">
            <div class="flex items-start justify-between mb-4">
              <h3 class="text-lg font-bold text-indigo-900">Pr√©via de E-mail ao Cliente</h3>
              <button id="close-email-preview"
                class="text-sm text-indigo-700 hover:text-indigo-900 font-semibold underline">Fechar</button>
            </div>
            <textarea id="email-draft"
              class="w-full border border-indigo-300 rounded-xl p-4 text-xs font-mono text-gray-800 bg-white min-h-[220px]"
              readonly></textarea>
            <p class="text-xs text-gray-500 mt-3">Copie e cole no Outlook / Gmail. O conte√∫do inclui uma tabela com as
              opera√ß√µes em atraso.</p>
          </section>
        </div>
      </section>

      <section id="tab-ocorrencias" class="tab">
        <div class="glass-card p-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">Gest√£o de Ocorr√™ncias</h2>
          <div class="mb-6 p-4 bg-gray-50 rounded-xl">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label class="block text-sm font-semibold mb-2">Booking</label>
                <input id="ocorrencias-filter-booking" type="text" placeholder="P10482561"
                  class="w-full input-modern border border-gray-300 p-3" />
              </div>
              <div>
                <label class="block text-sm font-semibold mb-2">Tipo</label>
                <select id="ocorrencias-filter-tipo" class="w-full input-modern border border-gray-300 p-3">
                  <option value="">Todos</option>
                  <option value="inicio_operacao">In√≠cio de Opera√ß√£o</option>
                  <option value="fim_operacao">Fim de Opera√ß√£o</option>
                  <option value="atraso">Atraso</option>
                  <option value="problema_operacional">Problema Operacional</option>
                  <option value="observacao">Observa√ß√£o</option>
                </select>
              </div>
              <div class="flex items-end">
                <button id="ocorrencias-search-btn"
                  class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-xl btn-modern font-semibold">üîç
                  Buscar</button>
              </div>
            </div>
          </div>
          <div id="ocorrencias-list" class="space-y-3">
            <p class="text-gray-500 text-center py-8">Nenhuma ocorr√™ncia encontrada. Use os filtros acima para buscar.
            </p>
          </div>
          <div class="mt-6 p-4 bg-gray-50 rounded-xl">
            <h3 class="text-sm font-semibold text-gray-800 mb-3">A√ß√µes com Ocorr√™ncias</h3>
            <div class="flex gap-3">
              <button id="ocorrencias-gerar-eml-btn"
                class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl btn-modern font-semibold">üìß Gerar
                E-mail (EML) de Ocorr√™ncias</button>
            </div>
            <p class="text-xs text-gray-500 mt-2">Gera um arquivo EML com as ocorr√™ncias filtradas que pode ser aberto
              no Outlook.</p>
          </div>
        </div>
      </section>

      <section id="tab-upload" class="tab">
        <div class="glass-card p-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-4">Upload de Dados de Rastreamento</h2>
          <p class="text-gray-600 mb-6">Selecione um arquivo Excel (.xlsx, .xls) ou CSV (.csv) para sincronizar.</p>
          <div class="mb-6">
            <input id="upload-file" type="file" accept=".xlsx,.xls,.csv"
              class="block w-full text-sm text-gray-600 file:mr-4 file:py-3 file:px-6 file:rounded-xl file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100 file:cursor-pointer cursor-pointer" />
          </div>
          <div id="upload-status" class="text-sm text-gray-600 mb-6"></div>
          <hr class="my-8 border-gray-200">
          <h3 class="text-xl font-bold text-gray-900 mb-4">Gest√£o de Dados</h3>
          <p class="text-gray-600 mb-6">Use para limpar todas as programa√ß√µes existentes (irrevers√≠vel).</p>
          <button id="clear-data-btn"
            class="bg-red-600 hover:bg-red-700 text-white font-semibold px-6 py-3 rounded-xl btn-modern">üóëÔ∏è Limpar
            Dados</button>
        </div>
      </section>

      <section id="tab-aprovacoes" class="tab">
        <div class="glass-card p-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">Aprova√ß√£o de Novos Usu√°rios</h2>
          <div class="overflow-x-auto border border-gray-200 rounded-xl">
            <table class="min-w-full divide-y divide-gray-200 table">
              <thead class="bg-gray-50">
                <tr class="text-left text-xs font-semibold text-gray-600 uppercase tracking-wide">
                  <th class="px-6 py-4">Email</th>
                  <th class="px-6 py-4">Nome</th>
                  <th class="px-6 py-4">Telefone</th>
                  <th class="px-6 py-4">CPF</th>
                  <th class="px-6 py-4">Tipo</th>
                  <th class="px-6 py-4">Empresa</th>
                  <th class="px-6 py-4">A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="pending-users-table-body" class="bg-white divide-y divide-gray-100 text-sm"></tbody>
            </table>
          </div>
        </div>
      </section>

      <div id="tab-analytics" class="tab">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">üìä Analytics e KPIs</h2>

        <div class="glass-card p-6 mb-6">
          <h3 class="text-lg font-semibold text-gray-700 mb-4">üîç Filtros</h3>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Cliente/Embarcador(es)</label>
              <select id="analytics-embarcador" multiple
                class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-purple-500">
                <option value="">Selecione um ou mais embarcadores</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Data In√≠cio</label>
              <input type="date" id="analytics-data-inicio"
                class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-purple-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Data Fim</label>
              <input type="date" id="analytics-data-fim"
                class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-purple-500">
            </div>
          </div>
          <div class="mt-4 flex gap-3">
            <button id="analytics-buscar-btn"
              class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-6 py-2 rounded-lg font-semibold hover:from-purple-700 hover:to-indigo-700 transition-all shadow-lg">
              üîç Buscar
            </button>
            <button id="analytics-limpar-btn"
              class="bg-gray-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-gray-600 transition-all">
              üóëÔ∏è Limpar Filtros
            </button>
          </div>
        </div>

        <div class="flex gap-3 mb-6">
          <button id="export-pdf-btn"
            class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold transition-all flex items-center gap-2 btn-modern shadow-lg hover:shadow-xl">
            üìÑ Exportar PDF
          </button>
          <button id="export-ppt-btn"
            class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg font-semibold transition-all flex items-center gap-2 btn-modern shadow-lg hover:shadow-xl">
            üìä Exportar PowerPoint
          </button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
          <div class="kpi kpi-gradient-1">
            <h3>Total de Opera√ß√µes</h3>
            <p id="kpi-total-ops-analytics">0</p>
          </div>
          <div class="kpi kpi-gradient-2">
            <h3>Total de Coletas</h3>
            <p id="kpi-total-coletas">0</p>
          </div>
          <div class="kpi kpi-gradient-3">
            <h3>Total de Entregas</h3>
            <p id="kpi-total-entregas">0</p>
          </div>
        </div>

        <div class="glass-card p-6 mb-6">
          <h3 class="text-lg font-semibold text-gray-700 mb-4">‚è±Ô∏è Pontualidade das Opera√ß√µes</h3>
          <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
            <div id="pont-card-no-prazo" class="analytics-card cursor-pointer hover:shadow-xl transition-all"
              data-categoria="no_prazo" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
              <div class="text-white p-4 rounded-lg">
                <div class="text-sm opacity-90 mb-1">‚úÖ No Prazo</div>
                <div class="text-3xl font-bold" id="pont-no-prazo-qtd">0</div>
                <div class="text-sm opacity-90 mt-1" id="pont-no-prazo-pct">0%</div>
              </div>
            </div>
            <div id="pont-card-ate1h" class="analytics-card cursor-pointer hover:shadow-xl transition-all"
              data-categoria="ate_1h" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
              <div class="text-white p-4 rounded-lg">
                <div class="text-sm opacity-90 mb-1">‚ö° At√© 1h</div>
                <div class="text-3xl font-bold" id="pont-ate1h-qtd">0</div>
                <div class="text-sm opacity-90 mt-1" id="pont-ate1h-pct">0%</div>
              </div>
            </div>
            <div id="pont-card-2a5h" class="analytics-card cursor-pointer hover:shadow-xl transition-all"
              data-categoria="de_2_a_5h" style="background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);">
              <div class="text-white p-4 rounded-lg">
                <div class="text-sm opacity-90 mb-1">‚ö†Ô∏è 2-5h</div>
                <div class="text-3xl font-bold" id="pont-2a5h-qtd">0</div>
                <div class="text-sm opacity-90 mt-1" id="pont-2a5h-pct">0%</div>
              </div>
            </div>
            <div id="pont-card-5a10h" class="analytics-card cursor-pointer hover:shadow-xl transition-all"
              data-categoria="de_5_a_10h" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
              <div class="text-white p-4 rounded-lg">
                <div class="text-sm opacity-90 mb-1">üî∂ 5-10h</div>
                <div class="text-3xl font-bold" id="pont-5a10h-qtd">0</div>
                <div class="text-sm opacity-90 mt-1" id="pont-5a10h-pct">0%</div>
              </div>
            </div>
            <div id="pont-card-mais10h" class="analytics-card cursor-pointer hover:shadow-xl transition-all"
              data-categoria="mais_10h" style="background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);">
              <div class="text-white p-4 rounded-lg">
                <div class="text-sm opacity-90 mb-1">üî¥ +10h</div>
                <div class="text-3xl font-bold" id="pont-mais10h-qtd">0</div>
                <div class="text-sm opacity-90 mt-1" id="pont-mais10h-pct">0%</div>
              </div>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div class="glass-card p-6">
            <h3 class="text-lg font-semibold text-gray-700 mb-4">üì¶ Pontualidade - Coletas</h3>
            <div class="flex items-center justify-between">
              <div>
                <div class="text-4xl font-bold text-purple-600" id="media-coletas">0%</div>
                <div class="text-sm text-gray-600 mt-2">
                  <span id="coletas-no-prazo">0</span> de <span id="coletas-total">0</span> no prazo
                </div>
              </div>
              <div style="width: 160px; height: 160px;">
                <canvas id="chart-coletas"></canvas>
              </div>
            </div>
          </div>
          <div class="glass-card p-6">
            <h3 class="text-lg font-semibold text-gray-700 mb-4">üöö Pontualidade - Entregas</h3>
            <div class="flex items-center justify-between">
              <div>
                <div class="text-4xl font-bold text-indigo-600" id="media-entregas">0%</div>
                <div class="text-sm text-gray-600 mt-2">
                  <span id="entregas-no-prazo">0</span> de <span id="entregas-total">0</span> no prazo
                </div>
              </div>
              <div style="width: 160px; height: 160px;">
                <canvas id="chart-entregas"></canvas>
              </div>
            </div>
          </div>
        </div>

        <div class="glass-card p-6 mb-6">
          <h3 class="text-lg font-semibold text-gray-700 mb-4">üìà Motivos de Atraso</h3>
          <div style="position: relative; height: 400px; max-height: 400px;">
            <canvas id="chart-motivos"></canvas>
          </div>
        </div>

        <div class="glass-card p-6 mb-6">
          <h3 class="text-lg font-semibold text-gray-700 mb-4">
            üéØ Target de Opera√ß√µes Coletas e Entregas 2025
          </h3>
          <div
            style="position: relative; height: 400px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
            <canvas id="target-chart"></canvas>
          </div>
        </div>
      </div>

      <section id="tab-ferrovia" class="tab">
        <div class="glass-card p-6 mb-6">
          <h2 class="text-2xl font-bold text-gray-800 mb-2">üöÇ Gest√£o de Ferrovia - Amcor</h2>
          <p class="text-gray-600 mb-4">Controle de fluxo: Porto ‚Æï Terminal ‚Æï Entrega</p>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-gray-200 mt-4">
            <div class="bg-gray-50 p-4 rounded-xl">
              <h4 class="font-bold text-gray-700 mb-3 text-sm">üì• Importar Opera√ß√µes</h4>
              <div class="flex flex-col gap-3">
                <input type="file" id="ferrovia-upload-file" accept=".xlsx,.xls"
                  class="text-xs w-full bg-white border p-2 rounded" />
                <div class="flex gap-2">
                  <button id="ferrovia-download-modelo-ops-btn"
                    class="bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700 text-xs font-bold flex-1">üì•
                    Modelo Ops</button>
                  <button id="ferrovia-limpar-btn"
                    class="bg-red-100 text-red-700 px-3 py-2 rounded hover:bg-red-200 text-xs font-bold">üóëÔ∏è Limpar
                    Tudo</button>
                </div>
              </div>
            </div>

            <div class="bg-gray-50 p-4 rounded-xl">
              <h4 class="font-bold text-gray-700 mb-3 text-sm">‚ö° Prioridades e Relat√≥rios</h4>
              <div class="flex flex-col gap-3">
                <div class="flex gap-2 items-center">
                  <input type="file" id="ferrovia-upload-prioridades-file" accept=".xlsx,.xls"
                    class="text-xs w-full bg-white border p-2 rounded" />
                </div>
                <div class="flex gap-2">
                  <button id="ferrovia-download-modelo-prio-btn"
                    class="bg-purple-600 text-white px-3 py-2 rounded hover:bg-purple-700 text-xs font-bold flex-1">üì•
                    Modelo Prio.</button>
                  <button id="ferrovia-gerar-relatorio-btn"
                    class="bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700 text-xs font-bold flex-1">üìÑ
                    Relat√≥rio</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
          <div class="kpi kpi-gradient-0 cursor-pointer hover:opacity-90 transition transform hover:-translate-y-1"
            id="kpi-ferrovia-maritimo">
            <h3>Transporte Mar√≠timo</h3>
            <p id="ferrovia-maritimo">0</p>
            <span class="text-sm opacity-90">aguardando chegada</span>
          </div>
          <div class="kpi kpi-gradient-1 cursor-pointer hover:opacity-90 transition transform hover:-translate-y-1"
            id="kpi-ferrovia-porto">
            <h3>No Porto</h3>
            <p id="ferrovia-no-porto">0</p>
            <span class="text-sm opacity-90">aguardando subida</span>
          </div>
          <div class="kpi kpi-gradient-2 cursor-pointer hover:opacity-90 transition transform hover:-translate-y-1"
            id="kpi-ferrovia-terminal">
            <h3>Terminal Apoio</h3>
            <p id="ferrovia-terminal">0</p>
            <span class="text-sm opacity-90">em armazenagem</span>
          </div>
          <div class="kpi kpi-gradient-3 cursor-pointer hover:opacity-90 transition transform hover:-translate-y-1"
            id="kpi-ferrovia-transito">
            <h3>Em Entrega</h3>
            <p id="ferrovia-transito">0</p>
            <span class="text-sm opacity-90">sa√≠ram do terminal</span>
          </div>
          <div class="kpi kpi-gradient-4 cursor-pointer hover:opacity-90 transition transform hover:-translate-y-1"
            id="kpi-ferrovia-entregues">
            <h3>Entregues</h3>
            <p id="ferrovia-entregues">0</p>
            <span class="text-sm opacity-90">finalizados</span>
          </div>
        </div>

        <div class="glass-card p-6">
          <h3 id="ferrovia-lista-titulo" class="text-lg font-semibold text-gray-700 mb-4">üì¶ Containers no Porto</h3>
          <div class="overflow-x-auto">
            <table class="w-full table">
              <thead>
                <tr class="border-b bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wide">
                  <th class="p-3 w-10 text-center">
                    <input type="checkbox" id="check-all-ferrovia" onclick="ferroviaActions.toggleSelectAll()"
                      class="cursor-pointer">
                  <th class="text-left p-3 text-sm font-semibold">Container</th>
                  <th class="text-left p-3 text-sm font-semibold">Booking</th>
                  <th class="text-left p-3 text-sm font-semibold">Embarcador</th>
                  <th class="text-left p-3 text-sm font-semibold">Datas (Porto/Term)</th>
                  <th class="text-center p-3 text-sm font-semibold">Armazenagem Total</th>
                  <th class="text-left p-3 text-sm font-semibold">Status</th>
                  <th class="text-right p-3 text-sm font-semibold">A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="ferrovia-terminal-tbody"></tbody>
            </table>
          </div>
        </div>
      </section>

    </div>
  </main>

  <script id="xlsx-lib" src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

  <script>
    const __firebase_config = JSON.stringify({
      apiKey: "AIzaSyAqz0eAaJwE38EAyTgbRk4CZryswDqvSBY",
      authDomain: "mercosul-teste.firebaseapp.com",
      projectId: "mercosul-teste",
      appId: "1:650943607449:web:73ec91b430ccaa55b77e08",
      measurementId: "G-KJHFXFLJ6K"
    });
  </script>
  <script type="module" src="./js/config.js"></script>
  <script type="module" src="./js/utilities.js"></script>
  <script type="module" src="./js/analytics.js"></script>
  <script type="module" src="./js/ferrovia.js"></script>
  <script type="module" src="./js/admin.js"></script>
  <script type="module" src="./js/export-functions.js"></script>

  <script type="module">
    import * as U from "./js/utils.js";
    window.calculateDelayInMinutes = U.calculateDelayInMinutes;
  </script>
</body>

</html>